<!DOCTYPE html>
<html>
<head>
  <title>Top Spotify Hits Visualization</title>
  <style>
    .circle {
      opacity: 0.7;
    }

    .circle:hover {
      fill: orange;
    }
    h1, h3, p {
      display: flex;
      justify-content: center;
    }
  </style>
</head>
<body>
  <h1>Top Spotify Hits</h1>
  <h3>Questions:</h3>
  <p>How does interactivity enhance the exploration of Top Spotify Hits?</p>
  <p>Which artists have more hits?</p>
  <p>What songs are you interested in hearing?</p>
  <svg id="chart"></svg>

  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script>
    // load the Spotify dataset
    d3.csv('spotify.csv').then(function(data) {
      // set up the chart dimensions
      const margin = { top: 20, right: 20, bottom: 20, left: 40 };
      const width = 1500 - margin.left - margin.right;
      const height = 900 - margin.top - margin.bottom;

      // svg element
      const svg = d3
        .select('#chart')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g')
        .attr('transform', `translate(${margin.left}, ${margin.top})`);

      // circles representing the songs
      const circles = svg
        .selectAll('.circle')
        .data(data)
        .enter()
        .append('circle')
        .attr('class', 'circle')
        .attr('r', function() {
          const minRadius = 10; 
          const maxRadius = 30; 
          return Math.random() * (maxRadius - minRadius) + minRadius;
        })
        .on('mouseover', function(d) {
          d3.select(this)
            .transition()
            .duration(200)
            .attr('r', 30)
            .attr('fill', 'orange');
        })
        .on('mouseout', function(d) {
          d3.select(this)
            .transition()
            .duration(200)
            .attr('r', function() {
              const minRadius = 10; 
              const maxRadius = 30; 
              return Math.random() * (maxRadius - minRadius) + minRadius;
            })
            .attr('fill', function() {
              const randomColor = `rgb(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255})`;
              return randomColor;
            });
        });

      // song and artist information
      circles.append('title').text(function(d) {
        return `${d.song} by ${d.artist}`;
      });

      // simulation
      const simulation = d3
        .forceSimulation(data)
        .force('center', d3.forceCenter(width / 2, height / 2))
        .force('collide', d3.forceCollide(25))
        .on('tick', ticked);

      // update circle positions 
      function ticked() {
        circles.attr('cx', function(d) {
          return d.x;
        }).attr('cy', function(d) {
          return d.y;
        });
      }

      // display the song titles
      circles.append('title').text(function(d) {
        return d.title;
      });
    });
  </script>
</body>
</html>
